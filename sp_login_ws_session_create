USE [vrsdb]
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

ALTER PROCEDURE [dbo].[login_ws_session_create]
    @session_id nvarchar(30),
    @user_id uniqueidentifier,
    @error_code nvarchar(10) = N'' OUTPUT,
    @return_status int = 0 OUTPUT
AS
BEGIN
    SET NOCOUNT ON;
    SET XACT_ABORT ON;

    BEGIN TRANSACTION;

    INSERT INTO dbo.sys_ws8_session (session_id, date_created, created_by)
    VALUES (@session_id, GETDATE(), @user_id);

    IF @@ROWCOUNT = 0
    BEGIN
        SET @error_code = N'294';
        ROLLBACK TRANSACTION;
        RETURN 0;
    END

    COMMIT TRANSACTION;

    SET @error_code = N'';
    SET @return_status = 1;
    RETURN 1;
END;
GO
